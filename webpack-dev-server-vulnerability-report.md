# webpack-dev-server Security Vulnerability Report

## Executive Summary

The project is affected by a **moderate severity** security vulnerability (CVE-2025-30360) in webpack-dev-server. The vulnerability allows attackers to potentially steal source code when users access a malicious website with non-Chromium browsers.

**Current Status:**
- **Affected Package:** webpack-dev-server 4.15.2 (via @docusaurus/core 3.8.1)
- **Severity:** Moderate (CVSS 5.8)
- **Fixed Version:** 5.2.1 or later
- **Impact:** Source code disclosure for development environments

## Vulnerability Details

### CVE-2025-30360: Cross-site WebSocket Hijacking

**Description:** webpack-dev-server versions <= 5.2.0 contain a vulnerability where the Origin header validation always allows IP address origins. This enables Cross-site WebSocket hijacking attacks.

**Attack Vector:**
1. Attacker hosts a malicious website on an IP address
2. Victim developer visits the malicious site while running webpack-dev-server
3. The malicious site can connect to the local webpack-dev-server WebSocket
4. Source code can be extracted through the Hot Module Replacement (HMR) mechanism

**Affected Browsers:** All non-Chromium browsers (Firefox, Safari, etc.). Chrome 94+ is protected due to Private Network Access controls.

## Impact Analysis

### Who is Affected?
- ✅ **Development environments** using `pnpm dev` (docusaurus start)
- ❌ **Production builds** are NOT affected
- ❌ **Deployed sites** on Vercel/Netlify are NOT affected

### Risk Assessment
- **Likelihood:** Low (requires specific conditions)
- **Impact:** High (source code disclosure)
- **Overall Risk:** Moderate

## Current Dependency Chain

```
lightyear (project root)
└── apps/docs/
    └── @docusaurus/core@3.8.1
        └── webpack-dev-server@4.15.2 ❌ (vulnerable)
```

## Mitigation Strategies

### 1. Immediate Workarounds (Recommended)

#### A. Restrict Development Server Access
The most effective immediate mitigation is to ensure the development server only listens on localhost:

```bash
# Current command (check if it's exposed)
pnpm dev

# If exposed, ensure it only binds to localhost
# In apps/docs/package.json, verify the dev script:
"dev": "docusaurus start --host localhost --port 4000"
```

#### B. Use Only Chromium-Based Browsers for Development
When running the development server, use:
- Chrome 94+
- Edge (Chromium)
- Brave
- Other Chromium-based browsers

### 2. Long-term Solutions

#### A. Migrate to Docusaurus Faster (Rspack)
Docusaurus 3.6+ includes an experimental "Docusaurus Faster" feature that can use Rspack instead of webpack:

1. Install the faster package:
   ```bash
   cd apps/docs
   pnpm add @docusaurus/faster
   ```

2. Update `docusaurus.config.js`:
   ```js
   const config = {
     future: {
       experimental_faster: true,
     },
     // ... rest of config
   };
   ```

This removes the dependency on webpack-dev-server entirely.

#### B. Wait for Docusaurus Update
Monitor Docusaurus releases for an update that includes webpack-dev-server 5.2.1+. Based on their release history, this may come in a future v4.x release.

#### C. Override Dependencies (Not Recommended)
While it's possible to force an upgrade using pnpm overrides, this is risky as it may break Docusaurus functionality:

```json
// pnpm-workspace.yaml (NOT RECOMMENDED without thorough testing)
{
  "pnpm": {
    "overrides": {
      "webpack-dev-server": "^5.2.1"
    }
  }
}
```

## Recommendations

### For Development Team:

1. **Immediate Action:**
   - Verify development servers are not exposed to network (localhost only)
   - Communicate to team members to use Chromium browsers for development

2. **Short-term (1-2 weeks):**
   - Test Docusaurus Faster (Rspack) on a branch
   - Set up monitoring for Docusaurus security updates

3. **Long-term:**
   - Plan migration to Docusaurus Faster or wait for official update
   - Consider implementing additional development security practices

### Security Best Practices:

1. Never expose development servers to public networks
2. Use VPN when working on public networks
3. Regularly update dependencies
4. Monitor security advisories for critical dependencies

## Monitoring

Set up alerts for:
- Docusaurus security advisories: https://github.com/facebook/docusaurus/security/advisories
- webpack-dev-server updates: https://github.com/webpack/webpack-dev-server/releases

## Conclusion

While this vulnerability is concerning, the actual risk to the project is low if proper development practices are followed. The vulnerability only affects development environments and requires specific conditions to exploit. By ensuring development servers are not exposed to the network and using Chromium-based browsers, the team can effectively mitigate the risk while waiting for an official fix.

The recommended approach is to:
1. Immediately verify and restrict development server access
2. Test and potentially adopt Docusaurus Faster (Rspack)
3. Monitor for official Docusaurus updates

---

**Report Date:** January 2025  
**Next Review:** Check for Docusaurus updates monthly