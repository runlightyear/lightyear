# Webpack-dev-server Security Vulnerability Report (CVE-2025-30360)

## Executive Summary

The project's documentation site (located in `apps/docs`) is affected by a moderate severity security vulnerability in webpack-dev-server. The vulnerability allows malicious websites to potentially steal source code when developers access the site using non-Chromium based browsers while the dev server is running.

## Vulnerability Details

- **CVE ID**: CVE-2025-30360
- **GHSA ID**: GHSA-9jgg-88mc-972h
- **Severity**: Moderate (CVSS 6.5/10)
- **CVSS Vector**: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N
- **Affected Component**: webpack-dev-server (npm)
- **Current Version in Project**: 4.15.2
- **Fixed Version**: 5.2.1
- **Dependency Chain**: @docusaurus/core@3.8.1 â†’ webpack-dev-server@4.15.2

## Technical Analysis

### Root Cause
The vulnerability stems from webpack-dev-server's insufficient validation of the Origin header in WebSocket connections. While the package checks Origin headers to prevent Cross-site WebSocket hijacking (CVE-2018-14732), it always allows IP address-based Origins. This creates a security hole where:

1. Attackers can serve malicious websites on IP addresses
2. These websites can connect to the developer's local webpack-dev-server via WebSocket
3. Using Hot Module Replacement (HMR) mechanisms, attackers can exfiltrate source code

### Attack Scenario
1. Developer runs `pnpm dev` in the `apps/docs` directory, starting Docusaurus with webpack-dev-server
2. Attacker sends a malicious link to the developer (e.g., `http://192.168.1.100/?target=http://localhost:8080`)
3. Developer clicks the link using a non-Chromium browser (Firefox, Safari, etc.)
4. Malicious JavaScript connects to the local webpack-dev-server WebSocket
5. Source code is exfiltrated through HMR updates

### Limitations
- **Does not affect Chrome 94+** and other Chromium-based browsers due to their non-HTTPS private access blocking feature
- Requires the developer to be running the development server
- Requires user interaction (clicking a malicious link)

## Impact Assessment

### Current Situation
- The project uses Docusaurus 3.8.1, which depends on webpack-dev-server 4.15.2
- Maximum installable version is 4.15.2, but the fix requires 5.2.1
- This creates a dependency conflict that prevents a simple update

### Risk Level for This Project
- **Development Environment**: HIGH - Developers running the docs site locally are vulnerable
- **Production Environment**: NONE - Production builds don't use webpack-dev-server
- **CI/CD**: NONE - Build processes don't expose the dev server

## Mitigation Strategies

### Short-term Solutions

1. **Developer Education**
   - Inform all developers about the vulnerability
   - Advise using Chrome/Chromium-based browsers when developing
   - Avoid clicking on suspicious links while running dev servers

2. **Network Configuration**
   - Ensure webpack-dev-server only binds to localhost (not 0.0.0.0)
   - Use firewall rules to block external access to development ports

3. **Development Practices**
   - Stop the dev server when not actively developing
   - Be cautious about accessing unknown websites during development

### Long-term Solutions

1. **Upgrade Docusaurus**
   - Monitor Docusaurus releases for updates that include webpack-dev-server 5.2.1+
   - Consider the new Docusaurus Faster infrastructure which uses Rspack instead of webpack

2. **Alternative Build Tools**
   - Docusaurus 3.6+ introduces experimental support for Rspack as a webpack replacement
   - This could bypass the webpack-dev-server vulnerability entirely

3. **Custom Webpack Configuration**
   - Investigate if it's possible to override the webpack-dev-server configuration to add additional security headers

## Recommendations

### Immediate Actions
1. âœ… Alert all developers about the vulnerability
2. âœ… Update developer guidelines to recommend Chrome/Chromium browsers
3. âœ… Review and restrict network bindings for development servers

### Near-term Actions
1. ðŸ“‹ Test Docusaurus Faster with Rspack as a potential solution
2. ðŸ“‹ Monitor Docusaurus GitHub for security updates
3. ðŸ“‹ Implement automated security scanning in CI/CD pipeline

### Long-term Actions
1. ðŸ“‹ Plan migration to newer Docusaurus version when available
2. ðŸ“‹ Consider implementing a Web Application Firewall (WAF) for development environments
3. ðŸ“‹ Establish a regular dependency update cycle

## Testing Docusaurus Faster (Rspack)

To potentially bypass this vulnerability by using Rspack instead of webpack:

```bash
cd apps/docs
pnpm add @docusaurus/faster
```

Then update `docusaurus.config.js`:
```javascript
module.exports = {
  // ... existing config
  future: {
    experimental_faster: true,
  },
};
```

This would replace webpack-dev-server with Rspack's dev server, potentially avoiding the vulnerability.

## Conclusion

While this vulnerability poses a real risk to developers, it requires specific conditions to exploit. The development-only nature and browser-specific limitations reduce its overall impact. However, given the sensitive nature of source code, immediate mitigation steps should be taken while planning for a long-term resolution through framework updates or alternative build tools.

## References
- [GitHub Advisory GHSA-9jgg-88mc-972h](https://github.com/advisories/GHSA-9jgg-88mc-972h)
- [Docusaurus 3.6 Release Notes - Faster Project](https://docusaurus.io/blog/releases/3.6)
- [webpack-dev-server Security Advisories](https://github.com/webpack/webpack-dev-server/security)